{
  "kind": "build_request",
  "title": "Temporary emergency admin bypass to force access to /admin dashboard (debug-only)",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-71",
      "text": "Implement a temporary, clearly-marked emergency bypass mode for the admin area that disables the normal authentication guard behavior and allows direct access to the admin dashboard route `/admin` without entering credentials.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "FORCE ADMIN ACCESS â€” EMERGENCY BYPASS\n\nGoal:\nGain admin dashboard access without login loop.\n\nActions:\n\n1. Disable authentication guard temporarily.\n\n2. Allow direct access to:\n/admin"
        ]
      },
      "acceptanceCriteria": [
        "When bypass mode is enabled, navigating to `/admin` renders the Admin dashboard without redirecting to `/admin/login`.",
        "When bypass mode is enabled, all admin CMS routes currently wrapped by `AdminGuard` (e.g. `/admin/vehicles`, `/admin/promotions`, `/admin/testimonials`, `/admin/blog`, `/admin/leads`, `/admin/stats`, `/admin/profile`, `/admin/media`) are accessible without being redirected to `/admin/login`.",
        "Bypass mode is clearly marked in code comments as temporary/debug-only and can be disabled by flipping a single flag/config (no need to revert multiple files).",
        "No public (non-`/admin`) routes, layouts, or components are modified."
      ]
    },
    {
      "id": "REQ-72",
      "text": "When bypass mode is enabled and no `caffeineAdminSession` exists in browser storage, automatically create and persist an admin session client-side with role = \"Super Admin\" so admin CMS React Query hooks can use a token immediately.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "3. If no session exists:\nAuto-create session with role = Super Admin."
        ]
      },
      "acceptanceCriteria": [
        "With bypass mode enabled and an empty browser storage state, the app creates a `caffeineAdminSession` entry automatically (using the existing `frontend/src/admin/auth/adminSession.ts` storage format) before admin CMS queries execute.",
        "The stored session contains `role: \"Super Admin\"` and a non-empty `token` string.",
        "Reloading the page at any admin route keeps access without re-triggering a login loop."
      ]
    },
    {
      "id": "REQ-73",
      "text": "Add a backend emergency bypass login path that (a) upserts an Active Super Admin record for email `puadsolihan@gmail.com` and (b) issues a valid admin session token without verifying any password, intended for temporary debugging only.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "4. Inject temporary admin record:\n\nEmail: puadsolihan@gmail.com\nRole: Super Admin\nStatus: Active\n\nSkip password verification."
        ]
      },
      "acceptanceCriteria": [
        "Backend exposes a dedicated method for emergency bypass that returns the same session shape as `adminLogin` (at least `{ token; role }`) and stores the created session in the existing `adminSessions` map so `requireAdminSession(token)` succeeds for CMS methods.",
        "Calling the bypass method results in an admin user record present for `puadsolihan@gmail.com` with `role = \"Super Admin\"` and `status = \"Active\"` (idempotent upsert; no duplicate email entries).",
        "Bypass method is clearly marked as temporary/debug-only in code comments.",
        "All user-facing error messages added/changed for this bypass are in English."
      ]
    },
    {
      "id": "REQ-74",
      "text": "Wire the frontend bypass flow to call the backend bypass login method (when enabled) so that the created `caffeineAdminSession.token` is a real backend-recognized token and admin CMS endpoints work end-to-end.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Purpose:\nConfirm CMS, storage, and admin UI function first.\nAuth system will be repaired later."
        ]
      },
      "acceptanceCriteria": [
        "With bypass mode enabled, the frontend obtains a token from the backend bypass method and stores it under `caffeineAdminSession` using the existing storage utilities.",
        "After bypass session creation, visiting admin pages that call admin-protected backend methods (e.g. `getVisitorStats(token)`, `getContacts(token)`, `getMediaAssets(token)`) succeeds without showing \"Admin session required\" errors.",
        "Disabling bypass mode restores the existing admin auth behavior (AdminGuard redirects unauthenticated users to `/admin/login`)."
      ]
    },
    {
      "id": "REQ-75",
      "text": "When bypass mode is enabled, redirect all `/admin/*` traffic that would normally land on the login page to the dashboard (`/admin`) so the login UI is effectively skipped during debugging.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "5. Redirect all /admin traffic directly to dashboard."
        ]
      },
      "acceptanceCriteria": [
        "With bypass mode enabled, navigating to `/admin/login` automatically navigates to `/admin` (replace navigation, no loop).",
        "No redirect behavior changes occur for non-admin routes."
      ]
    }
  ],
  "constraints": [
    "Do not modify any public (non-`/admin`) frontend pages, routes, layouts, or UI behavior.",
    "Keep all Motoko logic within the single backend actor (`backend/main.mo`); do not introduce additional backend services.",
    "The emergency bypass must be clearly marked as temporary/debug-only and easily removable/disabled.",
    "Use English for any user-facing text introduced or changed as part of this bypass."
  ],
  "nonGoals": [
    "Do not permanently fix or redesign the email/password authentication system in this change (bypass is for debugging only).",
    "Do not add third-party authentication providers or external services.",
    "Do not change CMS data models, CMS UI features, or public-site content as part of this bypass."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}